# MyBatis动态SQL  

&emsp;&emsp;MyBatis的强大特新之一便是它的动态SQl。  
&emsp;&emsp;在MyBatis3之前的版本中，使用动态SQL需要
学习和了解非常多的标签。现在MyBatis采用了功能强大的OGNL（Object-Graph Navigation Language）
表达式语言消除了许多其他标签，以下是MYBatis的动态SQL在XML中支持的几种标签。  
+ if  
+ choose(when,otherwise)  
+ trim(where,set)  
+ foreach  
+ bind  
    
## if用法  
&emsp;&emsp;if标签通常用于WHERE语句中，通过判断参数值
来决定是否使用某个查询条件，它也是常用于UPDATE语句中判断
是否更新某一字段，还可以在INSERT语句中来判断是否插入某个
字段的值。  
    
### 在where条件中使用if 
&emsp;&emsp;需求：实现一个用户高级查询功能，
根据输入的条件去检索用户信息。这个功能还支持以下三种情况：
当之输入用户名时，需要根据用户名进行模糊查询；当只输入邮箱时，
根据邮箱进行完全匹配；当同时输入用户名和邮箱时，
用这两个条件去查询匹配的用户。   
代码如下：  
```java  
    <select id="selectByUser" resultType="tk.mybatis.simple.model.SysUser">
        select id,
               user_name userName,
               user_password userPassword,
               user_email userEmail,
               user_info userInfo,
               head_img headImg,
               create_time createTime
        from sys_user
        where 1=1
        <if test="userName != null and userName != ''">
            and user_name like concat('%',#{userName},'%')
        </if>
        <if test="userEmail != null and userEmail != ''">
            and user_email = #{userEmail}
        </if>

       还可以用where标签来写-->
        <where>
            <if test="userName != null and userName != ''">
                and user_name like concat('%',#{userName},'%')
            </if>
            <if test="userEmail != '' and userEmail != null">
                and user_email = #{userEmail}
            </if>
        </where>
    </select>
```  
&emsp;&emsp;if标签有一个必填的属性test，
test的属性值是一个符合OGNL要求的判断表达式，
表达式的结果可以是true或false，除此之外所有
的非0都为true，只有0为false。为了方便理解，
在表达式中，建议只用true或false作为结果。  
+ 判断条件property != null 或property == null:
  适用于任何类型的字段，用于判断属性值是否为空。
+ 判断条件property ！= ''或property == '':仅适用于String类型的字段，
  用于判断是否为空字符串。  
+ and和or：当有多个判断条件时，使用and或or进行连接，嵌套的判断可以使用小括号分组。


